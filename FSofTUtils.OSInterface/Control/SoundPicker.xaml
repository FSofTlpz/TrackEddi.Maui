<?xml version="1.0" encoding="UTF-8"?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui" 
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:ctrl="clr-namespace:FSofTUtils.OSInterface.Control"
             xmlns:sound="clr-namespace:FSofTUtils.OSInterface.Sound"
             x:DataType="ctrl:SoundPicker"
             x:Class="FSofTUtils.OSInterface.Control.SoundPicker"
             x:Name="this">
   <ContentView.Content>
      <Grid>
         <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
            <RowDefinition Height="auto" />
         </Grid.RowDefinitions>

         <Border Grid.Row="0" Grid.Column="0" 
                 Margin="5"
                 Padding="5,1,5,1"
                 Stroke="DarkBlue"
                 BackgroundColor="Transparent">
            <Border.StrokeShape>
               <RoundRectangle CornerRadius="5,5,5,5" />
            </Border.StrokeShape>

            <CollectionView x:Name="myCollectionView" 
                            SelectionMode="Single"
                            SelectionChanged="myCollectionView_SelectionChanged"
                            ItemsSource="{Binding SoundDataList}">
               <CollectionView.ItemsLayout>
                  <LinearItemsLayout Orientation="Vertical"
                                     ItemSpacing="3"/>
               </CollectionView.ItemsLayout>

               <CollectionView.ItemTemplate>
                  <DataTemplate x:DataType="ctrl:SoundPicker">
                     <Border BackgroundColor="{Binding Source={x:Reference this}, Path=ItemColor}"
                             Stroke="Blue"
                             Padding="5"
                             Margin="5"
                             HorizontalOptions="Fill">
                        <Border.StrokeShape>
                           <RoundRectangle CornerRadius="10,10,10,10" />
                        </Border.StrokeShape>
                        <Border.GestureRecognizers>
                           <TapGestureRecognizer Tapped="Item_Tapped"/>
                        </Border.GestureRecognizers>
                        <VisualStateManager.VisualStateGroups>
                           <VisualStateGroup Name="CommonStates">
                              <VisualState Name="Normal" />
                              <VisualState Name="Selected">
                                 <VisualState.Setters>
                                    <Setter Property="BackgroundColor" Value="{Binding Source={x:Reference this}, Path=SelectedItemColor}" />
                                 </VisualState.Setters>
                              </VisualState>
                           </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>

                        <StackLayout Orientation="Horizontal"
                                     x:DataType="sound:SoundDataExt"
                                     HorizontalOptions="Center"
                                     VerticalOptions="Center">
                           <CheckBox Color="Black"
                                     VerticalOptions="Center"
                                     IsChecked="{Binding Active}"/>
                           <Label Text="{Binding Title}"
                                  TextColor="Black"
                                  FontSize="Medium"
                                  LineBreakMode="NoWrap"
                                  VerticalOptions="Center"/>
                        </StackLayout>
                     </Border>
                  </DataTemplate>
               </CollectionView.ItemTemplate>
            </CollectionView>
         </Border>

         <Border x:Name="frameAppendFile" 
                 Grid.Row="1" Grid.Column="0" 
                 IsVisible="{Binding Source={x:Reference this}, Path=FilePickerIsVisible}"
                 Margin="5"
                 Padding="10"
                 Stroke="DarkBlue"
                 BackgroundColor="{Binding Source={x:Reference this}, Path=GadgetsColor}">
            <Border.Shadow>
               <Shadow Brush="Gray" Offset="5,5" Radius="20" Opacity="0.8"/>
            </Border.Shadow>
            <Border.StrokeShape>
               <RoundRectangle CornerRadius="10,10,10,10" />
            </Border.StrokeShape>
            <Label Text="Datei anfügen"
                   TextColor="Black"
                   FontSize="Medium"
                   HorizontalOptions="Center"/>
            <Border.GestureRecognizers>
               <TapGestureRecognizer Tapped="appendFile_Tapped"/>
            </Border.GestureRecognizers>
         </Border>

         <Border x:Name="frameVolume" 
                 Grid.Row="2" Grid.Column="0" 
                 Stroke="DarkBlue"
                 IsVisible="{Binding Source={x:Reference this}, Path=VolumeSliderIsVisible}"
                 Margin="5"
                 Padding="10"
                 BackgroundColor="{Binding Source={x:Reference this}, Path=GadgetsColor}"
                 VerticalOptions="Center">
            <Border.StrokeShape>
               <RoundRectangle CornerRadius="10,10,10,10" />
            </Border.StrokeShape>
            <Border.Shadow>
               <Shadow Brush="Gray" Offset="5,5" Radius="20" Opacity="0.8"/>
            </Border.Shadow>
            <StackLayout Orientation="Vertical">
               <Label x:Name="labelVolume"
                      Text="Lautstärke"
                      TextColor="Black"
                      FontSize="Small"
                      HorizontalOptions="Center"/>
               <Slider x:Name="sliderVolume"
                       Minimum="0"
                       Maximum="1"
                       FlowDirection="LeftToRight"
                       Margin="10"
                       ThumbColor="DarkSlateBlue"
                       MinimumTrackColor="White"
                       ValueChanged="sliderVolume_ValueChanged"/>
            </StackLayout>
         </Border>

         <Grid Grid.Row="3" Grid.Column="0">
            <Grid>
               <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="1*" />
                  <ColumnDefinition Width="1*" />
               </Grid.ColumnDefinitions>

               <Border 
                  Grid.Row="0" Grid.Column="0" 
                  Margin="5"
                  Padding="10"
                  Stroke="DarkBlue"
                  BackgroundColor="{Binding Source={x:Reference this}, Path=GadgetsColor}"
                  VerticalOptions="Center">
                  <Border.StrokeShape>
                     <RoundRectangle CornerRadius="10,10,10,10" />
                  </Border.StrokeShape>
                  <Border.Shadow>
                     <Shadow Brush="Gray" Offset="5,5" Radius="20" Opacity="0.8"/>
                  </Border.Shadow>
                  <Border.GestureRecognizers>
                     <TapGestureRecognizer Tapped="cancel_Tapped"/>
                  </Border.GestureRecognizers>
                  <Label Text="abbrechen" TextColor="Red" FontSize="Medium" HorizontalOptions="Center" VerticalOptions="Center"/>
               </Border>

               <Border 
                  Grid.Row="0" Grid.Column="1" 
                  Margin="5"
                  Padding="10"
                  Stroke="DarkBlue"
                  BackgroundColor="{Binding Source={x:Reference this}, Path=GadgetsColor}"
                  VerticalOptions="Center">
                  <Border.StrokeShape>
                     <RoundRectangle CornerRadius="10,10,10,10" />
                  </Border.StrokeShape>
                  <Border.Shadow>
                     <Shadow Brush="Gray" Offset="5,5" Radius="20" Opacity="0.8"/>
                  </Border.Shadow>
                  <Border.GestureRecognizers>
                     <TapGestureRecognizer Tapped="ok_Tapped"/>
                  </Border.GestureRecognizers>
                  <Label Text="OK" TextColor="DarkGreen" FontSize="Medium" HorizontalOptions="Center" VerticalOptions="Center"/>
               </Border>
            </Grid>
         </Grid>
      </Grid>

   </ContentView.Content>
</ContentView>